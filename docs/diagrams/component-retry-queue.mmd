flowchart TD
    PLAN["Plan or failure event<br/>name, version, tags"] --> ENQ["Enqueue retry<br/>package, version, tags, recipes"]
    UI["UI/API enqueue action"] --> ENQ
    ENQ --> FILE["Retry queue backend<br/>file / Redis / Kafka"]
    FILE --> LIST["List queue"]
    FILE --> CLEAR["Clear queue"]
    FILE --> POP["Pop batch for worker"]
    POP --> WORKER["Go worker with Podman<br/>refinery-build per job<br/>posts logs/manifest"]
    LIST --> UI
    CLEAR --> UI
